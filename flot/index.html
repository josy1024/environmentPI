<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!-- saved from url=(0092)http://javascriptrrd.sourceforge.net/docs/javascriptrrd_v0.5.0/src/examples/rrdJFlotTwo.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1252"><script type="text/javascript" src="./index_files/binaryXHR.js"></script><script type="text/vbscript">
Function IEBinary_getByteAt(strBinary, iOffset)
	IEBinary_getByteAt = AscB(MidB(strBinary,iOffset+1,1))
End Function
Function IEBinary_getLength(strBinary)
	IEBinary_getLength = LenB(strBinary)
End Function
</script>

    <script type="text/javascript" src="./index_files/rrdFile.js"></script>
    <script type="text/javascript" src="./index_files/rrdMultiFile.js"></script>

    <!-- rrdFlot class needs the following four include files !-->
    <script type="text/javascript" src="./index_files/rrdFlotSupport.js"></script>
    <script type="text/javascript" src="./index_files/rrdFlot.js"></script>
    <script type="text/javascript" src="./index_files/jquery.js"></script>
    <script type="text/javascript" src="./index_files/jquery.flot.js"></script>
    <script type="text/javascript" src="./index_files/jquery.flot.selection.js"></script>
  
    <title>RRD Graphs with Flot</title>
  </head>

  <body>
    <h1 id="title">RRD Graphs with Flot</h1>

    RRD URL:
    <input type="text" id="input_fname1" value="example4_s1.rrd"><br>
    <input type="text" id="input_fname2" value="example4_s2.rrd"><br>
     <button onclick="fname_update()">Update</button>
    <hr>

    <table id="infotable" border="1">
        <tbody>
	<tr><td><b>RRD file</b></td><td id="fname1" colspan="2">example4_s1.rrd</td><td id="fname2" colspan="3">example4_s2.rrd</td></tr>
    </tbody></table>

    <div id="mygraph"><table><tbody><tr><td colspan="3">Resolution:<select id="mygraph_res"><option value="0">5min (2 days 13h total)</option><option value="1">60min (30 days total)</option><option value="2">12h (12 months total)</option></select></td><td>Select elements to plot:</td></tr><tr><td colspan="3"><div id="mygraph_graph" style="width: 500px; height: 300px; padding: 0px; position: relative;"><canvas class="base" width="500" height="300"></canvas><canvas class="overlay" width="500" height="300" style="position: absolute; left: 0px; top: 0px;"></canvas><div class="tickLabels" style="font-size:smaller"><div class="xAxis x1Axis" style="color:#545454"><div class="tickLabel" style="position:absolute;text-align:center;left:38px;top:268px;width:50px">May 8 8:00</div><div class="tickLabel" style="position:absolute;text-align:center;left:99px;top:268px;width:50px">May 8 16:00</div><div class="tickLabel" style="position:absolute;text-align:center;left:160px;top:268px;width:50px">May 9 0:00</div><div class="tickLabel" style="position:absolute;text-align:center;left:221px;top:268px;width:50px">May 9 8:00</div><div class="tickLabel" style="position:absolute;text-align:center;left:282px;top:268px;width:50px">May 9 16:00</div><div class="tickLabel" style="position:absolute;text-align:center;left:342px;top:268px;width:50px">May 10 0:00</div><div class="tickLabel" style="position:absolute;text-align:center;left:403px;top:268px;width:50px">May 10 8:00</div><div class="tickLabel" style="position:absolute;text-align:center;left:464px;top:268px;width:50px">May 10 16:00</div></div><div class="yAxis y1Axis" style="color:#545454"><div class="tickLabel" style="position:absolute;text-align:right;top:253px;right:479px;width:21px">0</div><div class="tickLabel" style="position:absolute;text-align:right;top:210px;right:479px;width:21px">100</div><div class="tickLabel" style="position:absolute;text-align:right;top:167px;right:479px;width:21px">200</div><div class="tickLabel" style="position:absolute;text-align:right;top:125px;right:479px;width:21px">300</div><div class="tickLabel" style="position:absolute;text-align:right;top:82px;right:479px;width:21px">400</div><div class="tickLabel" style="position:absolute;text-align:right;top:39px;right:479px;width:21px">500</div><div class="tickLabel" style="position:absolute;text-align:right;top:-4px;right:479px;width:21px">600</div></div></div><div class="legend"><div style="position: absolute; width: 114px; height: 22px; top: 9px; left: 33px; opacity: 0.85; background-color: rgb(255, 255, 255);"> </div><table style="position:absolute;top:9px;left:33px;;font-size:smaller;color:#545454"><tbody><tr><td class="legendColorBox"><div style="border:1px solid #ccc;padding:1px"><div style="width:4px;height:0;border:5px solid rgb(237,194,64);overflow:hidden"></div></div></td><td class="legendLabel">ClientGlideIdle</td></tr></tbody></table></div></div></td><td valign="top"><form id="mygraph_ds_cb"><input type="checkbox" name="ds" value="ClientGlideIdle" checked="">ClientGlideIdle<br><input type="checkbox" name="ds" value="ClientGlideRunning">ClientGlideRunning<br><input type="checkbox" name="ds" value="ClientGlideTotal">ClientGlideTotal<br><input type="checkbox" name="ds" value="ClientInfoAge">ClientInfoAge<br><input type="checkbox" name="ds" value="ClientJobsIdle">ClientJobsIdle<br><input type="checkbox" name="ds" value="ClientJobsRunning">ClientJobsRunning<br><input type="checkbox" name="ds" value="ReqIdle">ReqIdle<br><input type="checkbox" name="ds" value="ReqMaxRun">ReqMaxRun<br><input type="checkbox" name="ds" value="StatusHeld">StatusHeld<br><input type="checkbox" name="ds" value="StatusIdle">StatusIdle<br><input type="checkbox" name="ds" value="StatusIdleOther">StatusIdleOther<br><input type="checkbox" name="ds" value="StatusPending">StatusPending<br><input type="checkbox" name="ds" value="StatusRunning">StatusRunning<br><input type="checkbox" name="ds" value="StatusStageIn">StatusStageIn<br><input type="checkbox" name="ds" value="StatusStageOut">StatusStageOut<br><input type="checkbox" name="ds" value="StatusWait">StatusWait<br></form></td></tr><tr><td valign="top">Legend:<br><select id="mygraph_legend_sel"><option value="nw">Top</option><option value="sw">Bottom</option><option value="ne">TopRight</option><option value="se">BottomRight</option><option value="None">None</option></select></td><td align="right"><div id="mygraph_scale" style="width: 250px; height: 110px; padding: 0px; position: relative;"><canvas class="base" width="250" height="110"></canvas><canvas class="overlay" width="250" height="110" style="position: absolute; left: 0px; top: 0px;"></canvas><div class="tickLabels" style="font-size:smaller"><div class="xAxis x1Axis" style="color:#545454"><div class="tickLabel" style="position:absolute;text-align:center;left:41px;top:62px;width:35px">May 8 12:00</div><div class="tickLabel" style="position:absolute;text-align:center;left:84px;top:62px;width:35px">May 9 0:00</div><div class="tickLabel" style="position:absolute;text-align:center;left:126px;top:62px;width:35px">May 9 12:00</div><div class="tickLabel" style="position:absolute;text-align:center;left:169px;top:62px;width:35px">May 10 0:00</div><div class="tickLabel" style="position:absolute;text-align:center;left:211px;top:62px;width:35px">May 10 12:00</div></div><div class="yAxis y1Axis" style="color:#545454"><div class="tickLabel" style="position:absolute;text-align:right;top:47px;right:229px;width:21px">0</div><div class="tickLabel" style="position:absolute;text-align:right;top:37px;right:229px;width:21px">100</div><div class="tickLabel" style="position:absolute;text-align:right;top:27px;right:229px;width:21px">200</div><div class="tickLabel" style="position:absolute;text-align:right;top:16px;right:229px;width:21px">300</div><div class="tickLabel" style="position:absolute;text-align:right;top:6px;right:229px;width:21px">400</div><div class="tickLabel" style="position:absolute;text-align:right;top:-4px;right:229px;width:21px">500</div></div></div></div></td><td valign="top"> <br><input type="button" value="Reset selection"></td></tr></tbody></table></div>

    <script type="text/javascript">

      // Remove the Javascript warning
      document.getElementById("infotable").deleteRow(0);

      // fname and rrd_data are the global variable used by all the functions below
      fname1=document.getElementById("input_fname1").value;
      rrd_data1=undefined;
      fname2=document.getElementById("input_fname2").value;
      rrd_data2=undefined;

      // This function updates the Web Page with the data from the RRD archive header
      // when a new file is selected
      function update_fname() {
        if ((rrd_data1==undefined) || (rrd_data2==undefined)) {
          return; /* some data still missing */
        }

        rrd_data_sum=new RRDFileSum([rrd_data1,rrd_data2]);
      
        // Finally, update the file name and enable the update button
        document.getElementById("fname1").firstChild.data=fname1;
        document.getElementById("fname2").firstChild.data=fname2;

        var graph_opts={legend: { noColumns:4}};
        var ds_graph_opts={'Oscilator':{ color: "#ff8000", 
                                         lines: { show: true, fill: true, fillColor:"#ffff80"} },
                           'Idle':{ label: 'IdleJobs', color: "#00c0c0", 
                                    lines: { show: true, fill: true} },
                           'Running':{color: "#000000",yaxis:2}};

        // the rrdFlot object creates and handles the graph
        var f=new rrdFlot("mygraph",rrd_data_sum,graph_opts,ds_graph_opts);
      }

      // This is the callback function that,
      // given a binary file object,
      // verifies that it is a valid RRD archive
      // and performs the update of the Web page
      function update_fname_handler1(bf) {
          var i_rrd_data=undefined;
          try {
            var i_rrd_data=new RRDFile(bf);            
          } catch(err) {
            alert("File "+fname1+" is not a valid RRD archive!");
          }
          if (i_rrd_data!=undefined) {
            rrd_data1=i_rrd_data;
            update_fname()
          }
      }

      function update_fname_handler2(bf) {
          var i_rrd_data=undefined;
          try {
            var i_rrd_data=new RRDFile(bf);            
          } catch(err) {
            alert("File "+fname2+" is not a valid RRD archive!");
          }
          if (i_rrd_data!=undefined) {
            rrd_data2=i_rrd_data;
            update_fname()
          }
      }

      // this function is invoked when the RRD file name changes
      function fname_update() {
        /* invalidate them, so we know when they are both loaded */
        rrd_data1=undefined;
        rrd_data2=undefined;

        fname1=document.getElementById("input_fname1").value;
        try {
          FetchBinaryURLAsync(fname1,update_fname_handler1);
        } catch (err) {
           alert("Failed loading "+fname1+"\n"+err);
        }
        fname2=document.getElementById("input_fname2").value;
        try {
          FetchBinaryURLAsync(fname2,update_fname_handler2);
        } catch (err) {
           alert("Failed loading "+fname2+"\n"+err);
        }
      }

    </script>
  

</body></html>